<<<<<<< HEAD
{"version":3,"sources":["./src/app/Services/actualizarpuntos.service.ts","./src/app/Services/recompensas.service.ts","./src/app/recompensas/recompensas-routing.module.ts","./src/app/recompensas/recompensas.module.ts","./src/app/recompensas/recompensas.page.ts","./src/app/recompensas/recompensas.page.scss","./src/app/recompensas/recompensas.page.html"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAA2C;AAEO;IAMrC,uBAAuB,SAAvB,uBAAuB;IAElC,YAAmB,IAAgB;QAAhB,SAAI,GAAJ,IAAI,CAAY;IAAI,CAAC;IAExC,gBAAgB,CAAC,UAAc,EAAC,gBAAoB,EAAC,WAAe;QAElE,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,gGAAgG,GAAC,UAAU,GAAC,oBAAoB,GAAC,gBAAgB,GAAC,eAAe,GAAC,WAAW,GAAC,EAAE,CAAC,CAAC;IACzM,CAAC;CAKF;;YAlBQ,4DAAU;;AAMN,uBAAuB;IAHnC,yDAAU,CAAC;QACV,UAAU,EAAE,MAAM;KACnB,CAAC;GACW,uBAAuB,CAYnC;AAZmC;;;;;;;;;;;;;;;;;;;;ACRO;AACO;IAOrC,kBAAkB,SAAlB,kBAAkB;IAE7B,YAAmB,IAAgB;QAAhB,SAAI,GAAJ,IAAI,CAAY;IAAI,CAAC;IAExC,kBAAkB,CAAC,gBAAqB;QACtC,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,oHAAoH,GAAI,gBAAgB,CAAC,CAAC;IACjK,CAAC;IAEH,0GAA0G;IAC1G,IAAI;IAGF,gBAAgB,CAAC,WAAgB;QAC/B,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,uGAAuG,GAAG,WAAW,CAAC,CAAC;IAC9I,CAAC;CAIF;;YAzBQ,4DAAU;;AAON,kBAAkB;IAH9B,yDAAU,CAAC;QACV,UAAU,EAAE,MAAM;KACnB,CAAC;GACW,kBAAkB,CAkB9B;AAlB8B;;;;;;;;;;;;;;;;;;;;;ACRU;AACc;AAEF;AAErD,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,8DAAe;KAC3B;CACF,CAAC;IAMW,4BAA4B,SAA5B,4BAA4B;CAAG;AAA/B,4BAA4B;IAJxC,uDAAQ,CAAC;QACR,OAAO,EAAE,CAAC,kEAAqB,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,EAAE,CAAC,yDAAY,CAAC;KACxB,CAAC;GACW,4BAA4B,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;;AChBA;AACM;AACF;AAEA;AAE+B;AAEvB;IAWxC,qBAAqB,SAArB,qBAAqB;CAAG;AAAxB,qBAAqB;IATjC,uDAAQ,CAAC;QACR,OAAO,EAAE;YACP,yDAAY;YACZ,uDAAW;YACX,uDAAW;YACX,qFAA4B;SAC7B;QACD,YAAY,EAAE,CAAC,8DAAe,CAAC;KAChC,CAAC;GACW,qBAAqB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnBmC;AACO;AACF;AACzB;AACiB;AAGO;AACR;AACd;AACV;IAQ5B,eAAe,SAAf,eAAe;IAM1B,YACU,gBAAkC,EACnC,QAA2B,EAC3B,cAAgC,EAChC,wBAAgD,EAChD,cAAqC,EACrC,eAAgC,EAC/B,SAA0B,EAC1B,MAAa;QAPb,qBAAgB,GAAhB,gBAAgB,CAAkB;QACnC,aAAQ,GAAR,QAAQ,CAAmB;QAC3B,mBAAc,GAAd,cAAc,CAAkB;QAChC,6BAAwB,GAAxB,wBAAwB,CAAwB;QAChD,mBAAc,GAAd,cAAc,CAAuB;QACrC,oBAAe,GAAf,eAAe,CAAiB;QAC/B,cAAS,GAAT,SAAS,CAAiB;QAC1B,WAAM,GAAN,MAAM,CAAO;QAEnB,IAAI,CAAC,WAAW,GAAG,uEAA0B,CAAC;IAEhD,CAAC;IAKH,QAAQ;QACN,IAAI,CAAC,WAAW,GAAG,uEAA0B,CAAC;QAC9C,IAAI,CAAC,QAAQ,CAAC,kBAAkB,CAAC,4EAA+B,CAAC;aAChE,SAAS,CACR,CAAC,IAAI,EAAC,EAAE,GAAC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,EAAC,EAClC,CAAC,KAAK,EAAC,EAAE,GAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAC,CAC/B;QAGC,qEAAqE;QACrE,yDAAyD;QACzD,IAAI,CAAC,WAAW,GAAG,uEAA0B,CAAC;QAC9C,IAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,IAAI,CAAC,WAAW,CAAC;aACrD,SAAS,CACR,CAAC,IAAI,EAAC,EAAE,GAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,EAAC,EAChC,CAAC,KAAK,EAAC,EAAE,GAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAC,CAC/B;QAED,sDAAsD;QACxD,2GAA2G;QAC3G,cAAc;QACd,yCAAyC;QACzC,mCAAmC;QACnC,OAAO;IAIT,CAAC;IAEK,cAAc;;YAClB,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;gBAChC,MAAM,EAAE,QAAQ;gBAChB,OAAO,EAAE,+BAA+B;gBACxC,OAAO,EAAE;oBACP;wBACE,IAAI,EAAE,QAAQ;wBACd,IAAI,EAAE,QAAQ;wBACd,OAAO,EAAE,GAAG,EAAE;4BACZ,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;wBAChC,CAAC;qBACF;oBACD;wBACE,IAAI,EAAE,KAAK;wBACX,OAAO,EAAE,GAAG,EAAE;4BACZ,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;wBAC7B,CAAC;qBACF;iBACF;aACF,CAAC,CAAC;YACF,CAAC,MAAM,KAAK,CAAC,CAAC,OAAO,EAAE,CAAC;QAC3B,CAAC;KAAA;IAMK,wBAAwB;;YAC5B,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,QAAQ,EAAE,iBAAiB;gBAC3B,MAAM,EAAE,eAAe;gBACvB,OAAO,EAAE,kGAAkG;gBAC3G,OAAO,EAAE,CAAC,IAAI,CAAC;aAChB,CAAC,CAAC;YACH,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC;QACxB,CAAC;KAAA;IACK,eAAe;;YACnB,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,QAAQ,EAAE,iBAAiB;gBAC3B,MAAM,EAAE,OAAO;gBACf,OAAO,EAAE,kEAAkE;gBAC3E,OAAO,EAAE,CAAC,IAAI,CAAC;aAChB,CAAC,CAAC;YACH,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC;QACxB,CAAC;KAAA;IAGK,aAAa;;YACjB,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,QAAQ,EAAE,iBAAiB;gBAC3B,MAAM,EAAE,OAAO;gBACf,OAAO,EAAE,qDAAqD;gBAC9D,OAAO,EAAE,CAAC,IAAI,CAAC;aAChB,CAAC,CAAC;YACH,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC;QACxB,CAAC;KAAA;IAEK,qBAAqB;;YACzB,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,QAAQ,EAAE,iBAAiB;gBAC3B,MAAM,EAAE,OAAO;gBACf,OAAO,EAAE,8CAA8C;gBACvD,OAAO,EAAE,CAAC,IAAI,CAAC;aAChB,CAAC,CAAC;YACH,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC;QACxB,CAAC;KAAA;IAiBF,aAAa,CAAC,CAAC;QAEd,8CAA8C;QAC7C,IAAI,CAAC,gBAAgB,GAAE,CAAE,QAAQ,CAAC,cAAc,CAAC,QAAQ,CAAyB,CAAC,WAAW,CAAC,CAAC;QAEjG,iCAAiC;QACjC,IAAI,CAAC,cAAc,GAAG,CAAE,QAAQ,CAAC,cAAc,CAAC,gBAAgB,GAAG,CAAC,CAA4B,CAAC,WAAW,CAAC,CAAC;QAE9G,iFAAiF;QACjF,IAAI,CAAC,oBAAoB,GAAG,CAAE,QAAQ,CAAC,cAAc,CAAC,gBAAgB,GAAG,CAAC,CAA4B,CAAC,OAAO,CAAC,CAAC;QAEhH,6BAA6B;QAC7B,IAAI,OAAO,GAAG,CAAE,QAAQ,CAAC,cAAc,CAAC,OAAO,GAAC,CAAC,CAA0B,CAAC,EAAE,CAAC,CAAC;QAEhF,2DAA2D;QAC3D,IAAI,CAAC,UAAU,GAAC,CAAE,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAyB,CAAC,WAAW,CAAC,CAAC;QAG7F,4DAA4D;QAC5D,IAAI,mBAAmB,GAAG,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QAE/D,+DAA+D;QAC7D,IAAI,SAAS,GAAE,QAAQ,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAC/C,IAAI,SAAS,GAAE,QAAQ,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;QAE/C,iEAAiE;QAC/D,IAAI,CAAC,eAAe,GAAG,CAAE,QAAQ,CAAC,cAAc,CAAC,iBAAiB,GAAE,CAAC,CAAsB,CAAC,WAAW,CAAC,CAAC;QAKzG,OAAO,CAAC,GAAG,CAAE,IAAI,CAAC,eAAe,CAAC,CAAC;QACnC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAK7B,yBAAyB;QAE3B,gHAAgH;QAC9G,IAAI,CAAC,IAAI,mBAAmB,IAAI,IAAI,CAAC,oBAAoB,IAAE,IAAI,EAAC;YAG9D,oFAAoF;YAClF,IAAG,SAAS,GAAG,SAAS,EAAC;gBACvB,IAAI,CAAC,eAAe,EAAE,CAAC;gBACvB,OAAO;aAEN;YAEL,+DAA+D;YAC/D,IAAI,OAAO,CAAC,iEAAiE,CAAC,EAAE;gBAE9E,IAAI,SAAS,GAAG,QAAQ,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,QAAQ,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;gBAChF,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;gBAEvB,IAAI,YAAY,EAAE,iBAAiB,CAAC;gBACpC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC;gBAChC,iBAAiB,GAAG,SAAS,CAAC;gBAE9B,oEAAoE;gBAGxE,yEAAyE;gBACzE,IAAI,CAAC,wBAAwB,CAAC,gBAAgB,CAAC,IAAI,CAAC,UAAU,EAAC,iBAAiB,EAAC,YAAY,CAAC,CAAC,SAAS,CAAC,CAAC,IAAI,EAAC,EAAE;oBAC/G,IAAI,CAAC,KAAK,GAAC,IAAI,CAAC;oBAChB,IAAG,IAAI,CAAC,KAAK,CAAC,SAAS,IAAE,IAAI,EAAC;wBAC5B,sEAAsE;wBACpE,IAAI,CAAC,wBAAwB,EAAE,CAAC;wBAChC,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,IAAI,CAAC,WAAW,EAAC,IAAI,CAAC,eAAe,EAAE,4EAA+B,CAAC,CAAC,SAAS,CAAC,CAAC,IAAI,EAAC,EAAE;4BAC3H,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;4BAClB,OAAO,CAAC,GAAG,CAAE,IAAI,CAAC,KAAK,CAAC,CAAC;4BAEzB,QAAQ,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,SAAS,GAAE,SAAS,GAAC,EAAE,CAAC;wBAE5D,CAAC,EACD,CAAC,KAAK,EAAC,EAAE;4BACP,IAAI,CAAC,aAAa,EAAE,CAAC;wBACvB,CAAC,CAAC,CAAC;qBAEN;yBACG;wBACH,IAAI,CAAC,aAAa,EAAE,CAAC;qBACrB;gBAGH,CAAC,CAAC;aAGG;SAEF;QACD,oEAAoE;aAChE;YACF,IAAI,CAAC,qBAAqB,EAAE,CAAC;YAC7B,OAAO;SACR;QACD,qCAAqC;IAEvC,CAAC;CAEF;;YAzPQ,0EAAgB;YAJhB,6EAAkB;YAQlB,yEAAgB;YAPjB,uFAAuB;YAMvB,mFAAqB;YAJpB,2DAAe;YAAf,2DAAe;YAOf,oDAAM;;AAQF,eAAe;IAL3B,yDAAS,CAAC;QACT,QAAQ,EAAE,iBAAiB;QAC3B,gFAAsC;;KAEvC,CAAC;GACW,eAAe,CA2O3B;AA3O2B;;;;;;;;;;;;;AClB5B,+DAAe,8CAA8C,2HAA2H,E;;;;;;;;;;;;ACAxL,+DAAe,8ZAA8Z,gEAAgE,2CAA2C,aAAa,EAAE,0BAA0B,sHAAsH,mBAAmB,iCAAiC,sHAAsH,2BAA2B,6DAA6D,mgBAAmgB,yLAAyL,uBAAuB,uBAAuB,2BAA2B,eAAe,mBAAmB,gHAAgH,mBAAmB,6IAA6I,aAAa,gDAAgD,kWAAkW,mBAAmB,+LAA+L,sBAAsB,KAAK,mBAAmB,kYAAkY,wBAAwB,oHAAoH,E","file":"src_app_recompensas_recompensas_module_ts-es2015.js","sourcesContent":["import { Injectable } from '@angular/core';\n\nimport { HttpClient } from '@angular/common/http';\nimport { HttpClientModule } from '@angular/common/http';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ActualizarpuntosService {\n\n  constructor(public http: HttpClient) { }\n\n  ActualizarPuntos(cod_puntos:any,puntos_acumulado:any,cod_usuario:any)\n  {\n    return this.http.get(\"http://api.miscalleslimpiasrd.tecnolora.com/api/MisCallesLimpiasRD/ActualizarOrden?cod_puntos=\"+cod_puntos+\"&puntosacumulados=\"+puntos_acumulado+\"&cod_usuario=\"+cod_usuario+\"\");\n  }\n\n  // return this.http.get(\"https://localhost:44371/api/MisCallesLimpiasRD/ActualizarOrden/\"+cod_puntos+\"/\"+puntos_acumulado+\"/\"+cod_usuario+\"\");\n    \n  // }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { HttpClientModule } from '@angular/common/http';\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class RecompensasService {\n\n  constructor(public http: HttpClient) { }\n\n  obtenerrecompensas(cod_ayuntamiento: any){\n    return this.http.get('http://api.miscalleslimpiasrd.tecnolora.com/api/MisCallesLimpiasRD/ConsultarListadodeRecompensas?cod_ayuntamiento=' +  cod_ayuntamiento);\n  }\n\n//   return this.http.get('https://localhost:44371/api/MisCallesLimpiasRD/ConsultarListadodeRecompensas');\n// }\n\n\n  obtenerMisPuntos(cod_usuario: any){\n    return this.http.get('http://api.miscalleslimpiasrd.tecnolora.com/api/MisCallesLimpiasRD/ConsultarInfMisPuntos?cod_usuario=' + cod_usuario);\n  }\n\n//   return this.http.get('https://localhost:44371/api/MisCallesLimpiasRD/ConsultarInfMisPuntos/' + cod_usuario);\n// }\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { RecompensasPage } from './recompensas.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: RecompensasPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class RecompensasPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { RecompensasPageRoutingModule } from './recompensas-routing.module';\n\nimport { RecompensasPage } from './recompensas.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RecompensasPageRoutingModule\n  ],\n  declarations: [RecompensasPage]\n})\nexport class RecompensasPageModule {}\n","import { RecompensasService } from '../Services/recompensas.service';\nimport {ActualizarpuntosService} from '../Services/actualizarpuntos.service'\nimport { Component, OnInit,  ViewChild, ElementRef } from '@angular/core';\nimport { AlertController } from '@ionic/angular';\nimport { IonLoaderService } from '../Services/ion-loader.service';\n\nimport { interval, Subscription } from 'rxjs';\nimport {RegistroReciboService} from '../Services/registrorecibo.service';\nimport { MispuntosService } from '../Services/mispuntos.service';\nimport { Variableglobal } from '../variableglobal';\nimport { Router } from \"@angular/router\"; \n\n\n@Component({\n  selector: 'app-recompensas',\n  templateUrl: './recompensas.page.html',\n  styleUrls: ['./recompensas.page.scss'],\n})\nexport class RecompensasPage implements OnInit {\n  cod_usuario:any;\n  public datos:any;\n  subscription: Subscription;\n\n\n  constructor(\n    private ionLoaderService: IonLoaderService,\n    public servicio:RecompensasService, \n    public servicioPuntos: MispuntosService,\n    public servicioActualizarPuntos:ActualizarpuntosService,\n    public registroRecibo: RegistroReciboService,\n    public alertController: AlertController,\n    private alertCtrl: AlertController,\n    private router:Router\n    ) { \n      this.cod_usuario = Variableglobal.cod_usuario;\n\n    }\n  \n  recompensas:any;\n  misPuntos:any;\n  \n  ngOnInit() {\n    this.cod_usuario = Variableglobal.cod_usuario;\n    this.servicio.obtenerrecompensas(Variableglobal.cod_ayuntamiento)\n    .subscribe(\n      (data)=>{this.recompensas = data;},\n      (error)=>{console.log(error);}\n    )\n\n   \n      //Esta variable llamada this.cod_usuario almacena el ID del usuario. \n      //Obtenemos los puntos del usuario logeado corrientemente\n      this.cod_usuario = Variableglobal.cod_usuario;    \n      this.servicioPuntos.obtenerMisPuntos(this.cod_usuario)\n      .subscribe(\n        (data)=>{this.misPuntos = data;},\n        (error)=>{console.log(error);}\n      )\n\n      //Llamamos al procedimiento para actualizar los puntos\n    // this.servicioActualizarPuntos.ActualizarPuntos(this.cod_puntos, this.cod_usuario, this.puntosAcumulados)\n    // .subscribe(\n    //   (data)=>{this.recompensas = data;}, \n    //   (error)=>{console.log(error);}\n    // )   \n    \n\n    \n  }\n\n  async presentConfirm() {\n    let alert = this.alertCtrl.create({\n      header: \"Prueba\",\n      message: 'Do you want to buy this book?',\n      buttons: [\n        {\n          text: 'Cancel',\n          role: 'cancel',\n          handler: () => {\n            console.log('Cancel clicked');\n          }\n        },\n        {\n          text: 'Buy',\n          handler: () => {\n            console.log('Buy clicked');\n          }\n        }\n      ]\n    });\n     (await alert).present();\n  }\n\n\n\n\n\n  async AlertaRecompensaCambiada() {\n    const alert = await this.alertController.create({\n      cssClass: 'my-custom-class',\n      header: '¡Enhorabuena!',\n      message: 'Su recompensa ha sido procesada con exito, por favor dirigirse a su punto de cambio mas cercano.',\n      buttons: ['OK']\n    });\n    await alert.present();\n  }\n  async AlertaDeExceder() {\n    const alert = await this.alertController.create({\n      cssClass: 'my-custom-class',\n      header: 'Error',\n      message: 'El artículo seleccionado excede la cantidad de puntos acumulados',\n      buttons: ['OK']\n    });\n    await alert.present();\n  }\n\n\n  async AlertaDeError() {\n    const alert = await this.alertController.create({\n      cssClass: 'my-custom-class',\n      header: 'Error',\n      message: 'En estos momentos no se puede realizar dicha acción',\n      buttons: ['OK']\n    });\n    await alert.present();\n  }\n\n  async AlertaRecuerdeCambiar() {\n    const alert = await this.alertController.create({\n      cssClass: 'my-custom-class',\n      header: 'Error',\n      message: 'Recuerde seleccionar la recompensa a cambiar',\n      buttons: ['OK']\n    });\n    await alert.present();\n  }\n\n\n //Temporalmente tanto el cod_punto y cod_usuarios le asignaremos el 1 hasta poder generarlo de forma dinámica\n\n puntosAcumulados:any;\n precioArticulo:any;\n articuloSeleccionado:any;\n cod_recompensas:any;\n\n cod_puntos:any;\n\n \n\n\n\n\n canjearPuntos(i) {\n \n  //Almacena los puntos cumulados por el usuario\n   this.puntosAcumulados= ((document.getElementById(\"puntos\") as HTMLIonLabelElement).textContent);\n\n  //Almacena el precio del articulo\n  this.precioArticulo = ((document.getElementById('puntosArticulo' + i) as HTMLIonCheckboxElement).textContent);\n\n  //Valida cual de los artículos fue seleccionado o si un artículo fue seleccionado\n  this.articuloSeleccionado = ((document.getElementById('puntosArticulo' + i) as HTMLIonCheckboxElement).checked);\n\n  //Capturamos el id del boton \n  let botonId = ((document.getElementById('boton'+i) as HTMLIonButtonElement).id);\n\n  //Almacenamos el cod_puntos que está activo en ese momento.\n  this.cod_puntos=((document.getElementById('cod_puntos') as HTMLIonLabelElement).textContent);\n\n\n  //Seleccionamos el untimo caracter de los botones dinámicos.\n  let ultimoCaracterBoton = botonId.charAt(botonId.length - 1);\n\n//Cambiamos el tipo de datos a entero para poder hacer la resta\n  let puntosInt= parseInt(this.puntosAcumulados);\n  let precioInt =parseInt(this.precioArticulo);\n \n//Obtenemos el ID del artículo para luego insertarlo en el recibo\n  this.cod_recompensas = ((document.getElementById('cod_recompensas'+ i) as HTMLInputElement).textContent);\n\n\n \n\n  console.log( this.cod_recompensas);\n  console.log(this.cod_puntos);\n\n\n\n  \n  //Para registro de recibo\n\n//Condición que valida si el botón seleccionado y el index son el mismo, además si el checkbox está seleccionado\n  if (i == ultimoCaracterBoton && this.articuloSeleccionado==true){\n\n\n    //Condición que valida si los puntos de la recompensa exceden los puntos que tenemos\n      if(precioInt > puntosInt){\n        this.AlertaDeExceder();\n        return;\n\n        }\n        \n    //Confirma antes de procesar el cambio de recompensa por puntos\n    if (confirm('¿Está seguro de que desea cambiar sus puntos por este artículo?')) {\n     \n      let resultado = parseInt(this.puntosAcumulados) - parseInt(this.precioArticulo);\n      console.log(resultado);\n\n      let cod_usuarios, puntos_acumulados;\n      cod_usuarios = this.cod_usuario;\n      puntos_acumulados = resultado;\n\n      // this.ionLoaderService.simpleLoader(); No necesario en esta página\n\n \n  //Creamos los datos del recibo e insertamos los datos en la tabla Recibos\n  this.servicioActualizarPuntos.ActualizarPuntos(this.cod_puntos,puntos_acumulados,cod_usuarios).subscribe((data)=>{\n    this.datos=data;\n    if(this.datos.respuesta==\"OK\"){\n      // this.ionLoaderService.dismissLoader();  No necesario en esta página\n        this.AlertaRecompensaCambiada();\n        this.registroRecibo.IngresarRecibo(this.cod_usuario,this.cod_recompensas, Variableglobal.cod_ayuntamiento).subscribe((data)=>{\n          this.datos = data; \n          console.log (this.datos);\n\n          document.getElementById('puntos').innerHTML =resultado+\"\";\n          \n        },\n        (error)=>{\n          this.AlertaDeError();\n        });\n        \n    }\n    else{\n     this.AlertaDeError();\n    }\n    \n\n  })\n\n      \n      } \n\n    }\n    //Condición que devuelvel mensaje cuando no se marca ningún checkbox\n    else{\n      this.AlertaRecuerdeCambiar();\n      return;\n    }\n    // this.router.navigate(['/login']); \n  \n  }\n\n}\n\n\n\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJyZWNvbXBlbnNhcy5wYWdlLnNjc3MifQ== */\";","export default \"<ion-header [translucent]=\\\"true\\\">\\n    <!-- Agregamos un bucle for para que muestre los puntos disponibles -->\\n\\n    <ion-toolbar>\\n        <ion-buttons slot=\\\"start\\\">\\n            <ion-menu-button></ion-menu-button>\\n        </ion-buttons>\\n        <!-- Obtenemos los puntos acumulados -->\\n\\n        <!-- <script src=\\\"http://code.jquery.com/jquery-1.11.0.min.js\\\"></script>\\n  <script>\\n      $(function(){\\n          $(\\\"#codigo\\\").load(\\\"ajax/test.html\\\", function() {\\n          alert(\\\"Load was performed.\\\");\\n          });     \\n          \\n      })\\n  </script> -->\\n\\n        <ion-label *ngFor=\\\"let datosMisPuntos of misPuntos\\\" slot=\\\"end\\\" style=\\\"padding: 5px;\\\" id=\\\"puntos\\\">{{datosMisPuntos.puntosacumulados}}</ion-label>\\n\\n\\n        <ion-label *ngFor=\\\"let datosMisPuntos of misPuntos\\\" class=\\\"ocultar\\\" id=\\\"cod_puntos\\\">{{datosMisPuntos.cod_puntos}}</ion-label>\\n        <img slot=\\\"end\\\" style=\\\"padding: 5px;\\\" src=\\\"assets/imagenes/moneda.png\\\">\\n        <ion-title>Mis Puntos</ion-title>\\n\\n\\n    </ion-toolbar>\\n\\n</ion-header>\\n\\n<ion-content [fullscreen]=\\\"true\\\">\\n    <ion-header collapse=\\\"condense\\\">\\n        <ion-toolbar>\\n            <ion-title size=\\\"large\\\">Recompensas</ion-title>\\n        </ion-toolbar>\\n    </ion-header>\\n\\n    <div id=\\\"container\\\">\\n        <!-- Obtenemos todos los artículos disponibles recorriendo la bd con un ciclo foor -->\\n        <ion-card *ngFor=\\\"let recompensa of recompensas;  let i = index\\\">\\n            <ion-card-header>\\n                <!-- llamamos al nombre de la recompensa -->\\n                <ion-card-title>\\n                    <ion-label id=\\\"{{'cod_recompensas' + i}}\\\" class=\\\"ocultar\\\">{{recompensa.cod_recompensa}}</ion-label> {{recompensa.nombre}}</ion-card-title>\\n\\n            </ion-card-header>\\n            <ion-card-content>\\n                <img src={{recompensa.imagen}}>\\n                <br>\\n\\n                <!-- Asignamos un ID único a cada botón que se autogenere -->\\n                <ion-button id=\\\"{{'boton' + i}}\\\" color=\\\"warning\\\" (click)=\\\"canjearPuntos(i);\\\">\\n                    <ion-icon name=\\\"wallet\\\" slot=\\\"start\\\"></ion-icon>\\n                    Usar Puntos\\n                </ion-button>\\n\\n                <br>\\n                <ion-list>\\n                    <ion-item>\\n                        <!-- Obtenemos los puntos de la recompensa -->\\n                        <ion-label color=\\\"warning\\\">{{recompensa.puntos}}</ion-label>\\n                        <!-- Le asignamos un ID dinámico a cada kabel de puntos que se genere -->\\n\\n                        <ion-checkbox slot=\\\"end\\\" color=\\\"warning\\\" id=\\\"{{'puntosArticulo' + i}}\\\">{{recompensa.puntos}}</ion-checkbox>\\n\\n                        <label slot=\\\"start\\\" class=\\\"centrarlabel\\\"> Puntos</label>\\n                    </ion-item>\\n                </ion-list>\\n\\n                <br>\\n                <label class=\\\"centrarlabel\\\"><b>Descripcion:</b> </label>\\n                <!-- Llamamos a la descripcción de la recompensa -->\\n                <label class=\\\"centrarlabel\\\"> {{recompensa.descripcion}}</label>\\n            </ion-card-content>\\n        </ion-card>\\n\\n    </div>\\n    <ion-card>\\n\\n\\n\\n    </ion-card>\";"],"sourceRoot":"webpack:///"}
=======
{"version":3,"sources":["./src/app/Services/actualizarpuntos.service.ts","./src/app/Services/recompensas.service.ts","./src/app/recompensas/recompensas-routing.module.ts","./src/app/recompensas/recompensas.module.ts","./src/app/recompensas/recompensas.page.ts","./src/app/recompensas/recompensas.page.scss","./src/app/recompensas/recompensas.page.html"],"names":[],"mappings":"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","file":"src_app_recompensas_recompensas_module_ts-es2015.js","sourcesContent":["import { Injectable } from '@angular/core';\r\n\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { HttpClientModule } from '@angular/common/http';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ActualizarpuntosService {\r\n\r\n  constructor(public http: HttpClient) { }\r\n\r\n  ActualizarPuntos(cod_puntos:any,puntos_acumulado:any,cod_usuario:any)\r\n  {\r\n    return this.http.get(\"http://api.miscalleslimpiasrd.tecnolora.com/api/MisCallesLimpiasRD/ActualizarOrden?cod_puntos=\"+cod_puntos+\"&puntosacumulados=\"+puntos_acumulado+\"&cod_usuario=\"+cod_usuario+\"\");\r\n  }\r\n\r\n  // return this.http.get(\"https://localhost:44371/api/MisCallesLimpiasRD/ActualizarOrden/\"+cod_puntos+\"/\"+puntos_acumulado+\"/\"+cod_usuario+\"\");\r\n    \r\n  // }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { HttpClientModule } from '@angular/common/http';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class RecompensasService {\r\n\r\n  constructor(public http: HttpClient) { }\r\n\r\n  obtenerrecompensas(cod_ayuntamiento: any){\r\n    return this.http.get('http://api.miscalleslimpiasrd.tecnolora.com/api/MisCallesLimpiasRD/ConsultarListadodeRecompensas?cod_ayuntamiento=' +  cod_ayuntamiento);\r\n  }\r\n\r\n//   return this.http.get('https://localhost:44371/api/MisCallesLimpiasRD/ConsultarListadodeRecompensas');\r\n// }\r\n\r\n\r\n  obtenerMisPuntos(cod_usuario: any){\r\n    return this.http.get('http://api.miscalleslimpiasrd.tecnolora.com/api/MisCallesLimpiasRD/ConsultarInfMisPuntos?cod_usuario=' + cod_usuario);\r\n  }\r\n\r\n//   return this.http.get('https://localhost:44371/api/MisCallesLimpiasRD/ConsultarInfMisPuntos/' + cod_usuario);\r\n// }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { RecompensasPage } from './recompensas.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: RecompensasPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class RecompensasPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { RecompensasPageRoutingModule } from './recompensas-routing.module';\r\n\r\nimport { RecompensasPage } from './recompensas.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    RecompensasPageRoutingModule\r\n  ],\r\n  declarations: [RecompensasPage]\r\n})\r\nexport class RecompensasPageModule {}\r\n","import { RecompensasService } from '../Services/recompensas.service';\r\nimport {ActualizarpuntosService} from '../Services/actualizarpuntos.service'\r\nimport { Component, OnInit,  ViewChild, ElementRef } from '@angular/core';\r\nimport { AlertController } from '@ionic/angular';\r\nimport { IonLoaderService } from '../Services/ion-loader.service';\r\n\r\nimport { interval, Subscription } from 'rxjs';\r\nimport {RegistroReciboService} from '../Services/registrorecibo.service';\r\nimport { MispuntosService } from '../Services/mispuntos.service';\r\nimport { Variableglobal } from '../variableglobal';\r\nimport { Router } from \"@angular/router\"; \r\n\r\n\r\n@Component({\r\n  selector: 'app-recompensas',\r\n  templateUrl: './recompensas.page.html',\r\n  styleUrls: ['./recompensas.page.scss'],\r\n})\r\nexport class RecompensasPage implements OnInit {\r\n  cod_usuario:any;\r\n  public datos:any;\r\n  subscription: Subscription;\r\n\r\n\r\n  constructor(\r\n    private ionLoaderService: IonLoaderService,\r\n    public servicio:RecompensasService, \r\n    public servicioPuntos: MispuntosService,\r\n    public servicioActualizarPuntos:ActualizarpuntosService,\r\n    public registroRecibo: RegistroReciboService,\r\n    public alertController: AlertController,\r\n    private alertCtrl: AlertController,\r\n    private router:Router\r\n    ) { \r\n      this.cod_usuario = Variableglobal.cod_usuario;\r\n\r\n    }\r\n  \r\n  recompensas:any;\r\n  misPuntos:any;\r\n  \r\n  ngOnInit() {\r\n    this.cod_usuario = Variableglobal.cod_usuario;\r\n    this.servicio.obtenerrecompensas(Variableglobal.cod_ayuntamiento)\r\n    .subscribe(\r\n      (data)=>{this.recompensas = data;},\r\n      (error)=>{console.log(error);}\r\n    )\r\n\r\n   \r\n      //Esta variable llamada this.cod_usuario almacena el ID del usuario. \r\n      //Obtenemos los puntos del usuario logeado corrientemente\r\n      this.cod_usuario = Variableglobal.cod_usuario;    \r\n      this.servicioPuntos.obtenerMisPuntos(this.cod_usuario)\r\n      .subscribe(\r\n        (data)=>{this.misPuntos = data;},\r\n        (error)=>{console.log(error);}\r\n      )\r\n\r\n      //Llamamos al procedimiento para actualizar los puntos\r\n    // this.servicioActualizarPuntos.ActualizarPuntos(this.cod_puntos, this.cod_usuario, this.puntosAcumulados)\r\n    // .subscribe(\r\n    //   (data)=>{this.recompensas = data;}, \r\n    //   (error)=>{console.log(error);}\r\n    // )   \r\n    \r\n\r\n    \r\n  }\r\n\r\n  async presentConfirm() {\r\n    let alert = this.alertCtrl.create({\r\n      header: \"Prueba\",\r\n      message: 'Do you want to buy this book?',\r\n      buttons: [\r\n        {\r\n          text: 'Cancel',\r\n          role: 'cancel',\r\n          handler: () => {\r\n            console.log('Cancel clicked');\r\n          }\r\n        },\r\n        {\r\n          text: 'Buy',\r\n          handler: () => {\r\n            console.log('Buy clicked');\r\n          }\r\n        }\r\n      ]\r\n    });\r\n     (await alert).present();\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  async AlertaRecompensaCambiada() {\r\n    const alert = await this.alertController.create({\r\n      cssClass: 'my-custom-class',\r\n      header: '¡Enhorabuena!',\r\n      message: 'Su recompensa ha sido procesada con exito, por favor dirigirse a su punto de cambio mas cercano.',\r\n      buttons: ['OK']\r\n    });\r\n    await alert.present();\r\n  }\r\n  async AlertaDeExceder() {\r\n    const alert = await this.alertController.create({\r\n      cssClass: 'my-custom-class',\r\n      header: 'Error',\r\n      message: 'El artículo seleccionado excede la cantidad de puntos acumulados',\r\n      buttons: ['OK']\r\n    });\r\n    await alert.present();\r\n  }\r\n\r\n\r\n  async AlertaDeError() {\r\n    const alert = await this.alertController.create({\r\n      cssClass: 'my-custom-class',\r\n      header: 'Error',\r\n      message: 'En estos momentos no se puede realizar dicha acción',\r\n      buttons: ['OK']\r\n    });\r\n    await alert.present();\r\n  }\r\n\r\n  async AlertaRecuerdeCambiar() {\r\n    const alert = await this.alertController.create({\r\n      cssClass: 'my-custom-class',\r\n      header: 'Error',\r\n      message: 'Recuerde seleccionar la recompensa a cambiar',\r\n      buttons: ['OK']\r\n    });\r\n    await alert.present();\r\n  }\r\n\r\n\r\n //Temporalmente tanto el cod_punto y cod_usuarios le asignaremos el 1 hasta poder generarlo de forma dinámica\r\n\r\n puntosAcumulados:any;\r\n precioArticulo:any;\r\n articuloSeleccionado:any;\r\n cod_recompensas:any;\r\n\r\n cod_puntos:any;\r\n\r\n \r\n\r\n\r\n\r\n\r\n canjearPuntos(i) {\r\n \r\n  //Almacena los puntos cumulados por el usuario\r\n   this.puntosAcumulados= ((document.getElementById(\"puntos\") as HTMLIonLabelElement).textContent);\r\n\r\n  //Almacena el precio del articulo\r\n  this.precioArticulo = ((document.getElementById('puntosArticulo' + i) as HTMLIonCheckboxElement).textContent);\r\n\r\n  //Valida cual de los artículos fue seleccionado o si un artículo fue seleccionado\r\n  this.articuloSeleccionado = ((document.getElementById('puntosArticulo' + i) as HTMLIonCheckboxElement).checked);\r\n\r\n  //Capturamos el id del boton \r\n  let botonId = ((document.getElementById('boton'+i) as HTMLIonButtonElement).id);\r\n\r\n  //Almacenamos el cod_puntos que está activo en ese momento.\r\n  this.cod_puntos=((document.getElementById('cod_puntos') as HTMLIonLabelElement).textContent);\r\n\r\n\r\n  //Seleccionamos el untimo caracter de los botones dinámicos.\r\n  let ultimoCaracterBoton = botonId.charAt(botonId.length - 1);\r\n\r\n//Cambiamos el tipo de datos a entero para poder hacer la resta\r\n  let puntosInt= parseInt(this.puntosAcumulados);\r\n  let precioInt =parseInt(this.precioArticulo);\r\n \r\n//Obtenemos el ID del artículo para luego insertarlo en el recibo\r\n  this.cod_recompensas = ((document.getElementById('cod_recompensas'+ i) as HTMLInputElement).textContent);\r\n\r\n\r\n \r\n\r\n  console.log( this.cod_recompensas);\r\n  console.log(this.cod_puntos);\r\n\r\n\r\n\r\n  \r\n  //Para registro de recibo\r\n\r\n//Condición que valida si el botón seleccionado y el index son el mismo, además si el checkbox está seleccionado\r\n  if (i == ultimoCaracterBoton && this.articuloSeleccionado==true){\r\n\r\n\r\n    //Condición que valida si los puntos de la recompensa exceden los puntos que tenemos\r\n      if(precioInt > puntosInt){\r\n        this.AlertaDeExceder();\r\n        return;\r\n\r\n        }\r\n        \r\n    //Confirma antes de procesar el cambio de recompensa por puntos\r\n    if (confirm('¿Está seguro de que desea cambiar sus puntos por este artículo?')) {\r\n     \r\n      let resultado = parseInt(this.puntosAcumulados) - parseInt(this.precioArticulo);\r\n      console.log(resultado);\r\n\r\n      let cod_usuarios, puntos_acumulados;\r\n      cod_usuarios = this.cod_usuario;\r\n      puntos_acumulados = resultado;\r\n\r\n      // this.ionLoaderService.simpleLoader(); No necesario en esta página\r\n\r\n \r\n  //Creamos los datos del recibo e insertamos los datos en la tabla Recibos\r\n  this.servicioActualizarPuntos.ActualizarPuntos(this.cod_puntos,puntos_acumulados,cod_usuarios).subscribe((data)=>{\r\n    this.datos=data;\r\n    if(this.datos.respuesta==\"OK\"){\r\n      // this.ionLoaderService.dismissLoader();  No necesario en esta página\r\n        this.AlertaRecompensaCambiada();\r\n        this.registroRecibo.IngresarRecibo(this.cod_usuario,this.cod_recompensas, Variableglobal.cod_ayuntamiento).subscribe((data)=>{\r\n          this.datos = data; \r\n          console.log (this.datos);\r\n\r\n          document.getElementById('puntos').innerHTML =resultado+\"\";\r\n          \r\n        },\r\n        (error)=>{\r\n          this.AlertaDeError();\r\n        });\r\n        \r\n    }\r\n    else{\r\n     this.AlertaDeError();\r\n    }\r\n    \r\n\r\n  })\r\n\r\n      \r\n      } \r\n\r\n    }\r\n    //Condición que devuelvel mensaje cuando no se marca ningún checkbox\r\n    else{\r\n      this.AlertaRecuerdeCambiar();\r\n      return;\r\n    }\r\n    // this.router.navigate(['/login']); \r\n  \r\n  }\r\n\r\n}\r\n\r\n\r\n\r\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJyZWNvbXBlbnNhcy5wYWdlLnNjc3MifQ== */\";","export default \"<ion-header [translucent]=\\\"true\\\">\\r\\n    <!-- Agregamos un bucle for para que muestre los puntos disponibles -->\\r\\n\\r\\n    <ion-toolbar>\\r\\n        <ion-buttons slot=\\\"start\\\">\\r\\n            <ion-menu-button></ion-menu-button>\\r\\n        </ion-buttons>\\r\\n        <!-- Obtenemos los puntos acumulados -->\\r\\n\\r\\n        <!-- <script src=\\\"http://code.jquery.com/jquery-1.11.0.min.js\\\"></script>\\r\\n  <script>\\r\\n      $(function(){\\r\\n          $(\\\"#codigo\\\").load(\\\"ajax/test.html\\\", function() {\\r\\n          alert(\\\"Load was performed.\\\");\\r\\n          });     \\r\\n          \\r\\n      })\\r\\n  </script> -->\\r\\n\\r\\n        <ion-label *ngFor=\\\"let datosMisPuntos of misPuntos\\\" slot=\\\"end\\\" style=\\\"padding: 5px;\\\" id=\\\"puntos\\\">{{datosMisPuntos.puntosacumulados}}</ion-label>\\r\\n\\r\\n\\r\\n        <ion-label *ngFor=\\\"let datosMisPuntos of misPuntos\\\" class=\\\"ocultar\\\" id=\\\"cod_puntos\\\">{{datosMisPuntos.cod_puntos}}</ion-label>\\r\\n        <img slot=\\\"end\\\" style=\\\"padding: 5px;\\\" src=\\\"assets/imagenes/moneda.png\\\">\\r\\n        <ion-title>Mis Puntos</ion-title>\\r\\n\\r\\n\\r\\n    </ion-toolbar>\\r\\n\\r\\n</ion-header>\\r\\n\\r\\n<ion-content [fullscreen]=\\\"true\\\">\\r\\n    <ion-header collapse=\\\"condense\\\">\\r\\n        <ion-toolbar>\\r\\n            <ion-title size=\\\"large\\\">Recompensas</ion-title>\\r\\n        </ion-toolbar>\\r\\n    </ion-header>\\r\\n\\r\\n    <div id=\\\"container\\\">\\r\\n        <!-- Obtenemos todos los artículos disponibles recorriendo la bd con un ciclo foor -->\\r\\n        <ion-card *ngFor=\\\"let recompensa of recompensas;  let i = index\\\">\\r\\n            <ion-card-header>\\r\\n                <!-- llamamos al nombre de la recompensa -->\\r\\n                <ion-card-title>\\r\\n                    <ion-label id=\\\"{{'cod_recompensas' + i}}\\\" class=\\\"ocultar\\\">{{recompensa.cod_recompensa}}</ion-label> {{recompensa.nombre}}</ion-card-title>\\r\\n\\r\\n            </ion-card-header>\\r\\n            <ion-card-content>\\r\\n                <img src={{recompensa.imagen}}>\\r\\n                <br>\\r\\n\\r\\n                <!-- Asignamos un ID único a cada botón que se autogenere -->\\r\\n                <ion-button id=\\\"{{'boton' + i}}\\\" color=\\\"warning\\\" (click)=\\\"canjearPuntos(i);\\\">\\r\\n                    <ion-icon name=\\\"wallet\\\" slot=\\\"start\\\"></ion-icon>\\r\\n                    Usar Puntos\\r\\n                </ion-button>\\r\\n\\r\\n                <br>\\r\\n                <ion-list>\\r\\n                    <ion-item>\\r\\n                        <!-- Obtenemos los puntos de la recompensa -->\\r\\n                        <ion-label color=\\\"warning\\\">{{recompensa.puntos}}</ion-label>\\r\\n                        <!-- Le asignamos un ID dinámico a cada kabel de puntos que se genere -->\\r\\n\\r\\n                        <ion-checkbox slot=\\\"end\\\" color=\\\"warning\\\" id=\\\"{{'puntosArticulo' + i}}\\\">{{recompensa.puntos}}</ion-checkbox>\\r\\n\\r\\n                        <label slot=\\\"start\\\" class=\\\"centrarlabel\\\"> Puntos</label>\\r\\n                    </ion-item>\\r\\n                </ion-list>\\r\\n\\r\\n                <br>\\r\\n                <label class=\\\"centrarlabel\\\"><b>Descripcion:</b> </label>\\r\\n                <!-- Llamamos a la descripcción de la recompensa -->\\r\\n                <label class=\\\"centrarlabel\\\"> {{recompensa.descripcion}}</label>\\r\\n            </ion-card-content>\\r\\n        </ion-card>\\r\\n\\r\\n    </div>\\r\\n    <ion-card>\\r\\n\\r\\n\\r\\n\\r\\n    </ion-card>\";"],"sourceRoot":"webpack:///"}
>>>>>>> 64578ea12ddb2eae1cfff82b5b2eeeba482d2aae
